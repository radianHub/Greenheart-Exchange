<template>
    <lightning-card title={cardTitle} icon-name="utility:file">
        <template lwc:if={isLoading}>
            <!-- Show spinner when loading -->
            <lightning-spinner 
            alternative-text="Loading" 
            size="medium"
            variant="brand"
            
          ></lightning-spinner>
        </template>
        <template lwc:else>
                <!-- Initial form creates a Document__c record to upload the file against -->
                    <lightning-record-edit-form object-api-name={objectName} record-id={documentId} onsuccess={handleSuccess}
                    onerror={handleError}>
                        <lightning-messages></lightning-messages>
                            <div class="slds-grid slds-var-m-around_medium">
                                <div class="slds-col slds-size_1-of-2">
                                    <span><lightning-input-field field-name={fields.name} required> </lightning-input-field></span>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <span><lightning-input-field field-name={fields.type} required> </lightning-input-field></span>
                                </div>
                            </div>
                            <div class="slds-grid slds-var-m-around_medium">
                                <div class="slds-col slds-size_1-of-2">
                                    <span>
                                        <!-- After the document record is created, use the recordId to pass in to the file -->
                                        <lightning-file-upload
                                            label="Upload Files"
                                            name="fileUploader"
                                            accept={acceptedFormats}
                                            record-id={documentId}
                                            onuploadfinished={handleUploadFinished}
                                            required>
                                        </lightning-file-upload>
                                        <p><b>{fileName}</b></p>
                                    </span>
                                </div>
                            </div>                                                                
                    </lightning-record-edit-form>
        </template>
        <div slot="footer" class="footerButton">
                <lightning-button 
                    variant="brand"
                    label="Done" 
                    title="Done" 
                    type="button"
                    onclick={handleDone} 
                    class="slds-var-m-horizontal_small" 
                ></lightning-button>
                <lightning-button 
                    variant="brand"
                    label="Cancel" 
                    title="Cancel" 
                    type="button"
                    onclick={handleCancel}
                ></lightning-button>
        </div>
    </lightning-card>
</template>